import{r as a,j as s,i as V}from"./react-vendor-C2vFB_vl.js";import{H as B}from"./Header-BSuf_loV.js";import{d as L,P as D}from"./ai-engine-JLcQPJPS.js";import{f as I,q as G,c as H,u as _}from"./core-libs-c5XOvvj3.js";import"./wellnesscafe-bowl-v2-Lr1jIdTX.js";import"./ui-heavy-C7pdA4pD.js";const F=l=>l?l.charAt(0).toUpperCase()+l.slice(1):"",k=({type:l="sobriety"})=>{const[t,o]=a.useState([]),[M,g]=a.useState(!0),[u,f]=a.useState(""),[c,b]=a.useState(""),[i,j]=a.useState(""),[d,w]=a.useState(""),[m,v]=a.useState(""),[p,N]=a.useState(!1),A=a.useMemo(()=>`assistant_${l}`,[l]);a.useEffect(()=>{let e=!0;return(async()=>{g(!0);try{if(!L){o([]);return}const n=(await I(G(H(L,A),_("name")))).docs.map(h=>({id:h.id,...h.data()}));if(!e)return;o(n)}catch(r){if(console.warn("assistants fs fetch failed",r),!e)return;o([])}finally{e&&g(!1)}})(),()=>{e=!1}},[A]);const $=a.useMemo(()=>Array.from(new Set(t.map(e=>e.state).filter(Boolean))).sort(),[t]),E=a.useMemo(()=>Array.from(new Set(t.map(e=>e.city).filter(Boolean))).sort(),[t]),T=a.useMemo(()=>{const e=new Set;for(const r of t)if(Array.isArray(r.insurance))for(const n of r.insurance)e.add(String(n));return Array.from(e).sort()},[t]),q=a.useMemo(()=>{const e=new Set;for(const r of t)if(Array.isArray(r.gender))for(const n of r.gender)e.add(String(n));return Array.from(e).sort()},[t]),x=a.useMemo(()=>{const e=u.toLowerCase();return t.filter(r=>{const n=(r.name||"").toLowerCase(),h=(r.description||"").toLowerCase(),C=(r.city||"").toLowerCase(),S=(r.state||"").toLowerCase(),O=Array.isArray(r.insurance)?r.insurance.map(y=>String(y).toLowerCase()):[],P=Array.isArray(r.gender)?r.gender.map(y=>String(y).toLowerCase()):[];return(!e||n.includes(e)||h.includes(e)||C.includes(e)||S.includes(e))&&(!p||!!r.verified)&&(!c||S===c.toLowerCase())&&(!i||C===i.toLowerCase())&&(!d||O.includes(d.toLowerCase()))&&(!m||P.includes(m.toLowerCase()))})},[t,u,c,i,d,m,p]);return M?s.jsxs("div",{className:"container max-w-[980px] mx-auto my-8 px-4",children:["Loading ",F(l)," directoryâ€¦"]}):s.jsxs("div",{className:"container max-w-[980px] mx-auto my-8 px-4",children:[s.jsxs("header",{className:"page-hero",children:[s.jsxs("h1",{children:[F(l)," Assistance"]}),s.jsxs("p",{children:["Search ",t.length," listings from trusted sources and local corrections."]})]}),s.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3 py-3 border-b border-gray-200",children:[s.jsxs("div",{className:"flex-1 flex flex-col md:flex-row gap-3",children:[s.jsx("input",{type:"search",value:u,onChange:e=>f(e.target.value),placeholder:"Search by name, description, city, state",className:"w-full md:flex-1 rounded-md border border-gray-300 px-3 py-2 text-sm backdrop-blur-md bg-white/60","aria-label":"Search assistants"}),s.jsxs("select",{value:c,onChange:e=>b(e.target.value),className:"w-full md:w-48 rounded-md border border-gray-300 px-3 py-2 text-sm backdrop-blur-md bg-white/60","aria-label":"Filter by state",children:[s.jsx("option",{value:"",children:"All states"}),$.map(e=>s.jsx("option",{value:e,children:e},e))]}),s.jsxs("select",{value:i,onChange:e=>j(e.target.value),className:"w-full md:w-48 rounded-md border border-gray-300 px-3 py-2 text-sm backdrop-blur-md bg-white/60","aria-label":"Filter by city",children:[s.jsx("option",{value:"",children:"All cities"}),E.map(e=>s.jsx("option",{value:e,children:e},e))]}),s.jsxs("select",{value:d,onChange:e=>w(e.target.value),className:"w-full md:w-56 rounded-md border border-gray-300 px-3 py-2 text-sm backdrop-blur-md bg-white/60","aria-label":"Filter by insurance",children:[s.jsx("option",{value:"",children:"All insurance"}),T.map(e=>s.jsx("option",{value:e,children:e},e))]}),s.jsxs("select",{value:m,onChange:e=>v(e.target.value),className:"w-full md:w-48 rounded-md border border-gray-300 px-3 py-2 text-sm backdrop-blur-md bg-white/60","aria-label":"Filter by gender",children:[s.jsx("option",{value:"",children:"All genders"}),q.map(e=>s.jsx("option",{value:e,children:e},e))]}),s.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[s.jsx("input",{type:"checkbox",checked:p,onChange:e=>N(e.target.checked)})," Verified only"]}),(c||i||d||m||p||u)&&s.jsx("button",{type:"button",className:"ghost-btn",onClick:()=>{f(""),b(""),j(""),w(""),v(""),N(!1)},children:"Clear"})]}),s.jsxs("div",{className:"text-sm text-gray-600",children:[x.length," result",x.length===1?"":"s"]})]}),s.jsxs("section",{className:"card-grid section",children:[x.slice(0,200).map(e=>{const r=e.id||`${e.name}-${e.city}`;return s.jsxs("div",{className:"p-card",children:[s.jsx("h3",{children:e.name}),s.jsxs("p",{className:"text-gray-700 my-1.5",children:[e.city,e.state?`, ${e.state}`:""]}),e.verified&&s.jsx("span",{className:"specialty-tag mr-1.5",children:"Verified"}),Array.isArray(e.tags)&&e.tags.length>0&&s.jsx("p",{className:"my-1.5",children:e.tags.map(n=>s.jsx("span",{className:"specialty-tag mr-1.5",children:n},n))}),Array.isArray(e.insurance)&&e.insurance.length>0&&s.jsx("p",{className:"my-1.5",children:e.insurance.map(n=>s.jsx("span",{className:"specialty-tag mr-1.5",children:n},n))}),e.description&&s.jsx("p",{className:"text-gray-700 my-1.5",children:e.description}),e.contact?.url&&s.jsx("p",{className:"mt-2",children:s.jsx("a",{href:e.contact.url,target:"_blank",rel:"noreferrer",className:"ghost-btn",children:"Visit site"})}),s.jsxs("div",{className:"flex gap-2 mt-2",children:[e.contact?.phone&&s.jsx("a",{href:`tel:${e.contact.phone}`,className:"ghost-btn",children:"Call"}),e.contact?.email&&s.jsx("a",{href:`mailto:${e.contact.email}`,className:"ghost-btn",children:"Email"})]})]},r)}),x.length===0&&s.jsx("p",{children:"No listings found."})]})]})};k.propTypes={type:D.oneOf(["sobriety","housing","legal","funding"])};const Q=["sobriety","housing","legal","funding"],X=()=>{const{type:l}=V(),t=(l||"").toLowerCase(),o=Q.includes(t)?t:"sobriety";return s.jsxs("div",{className:"page",children:[s.jsx(B,{}),s.jsx(k,{type:o})]})};export{X as default};
