import{r as o,j as s}from"./react-vendor-C2vFB_vl.js";import{d as i}from"./ai-engine-JLcQPJPS.js";import{q as N,c as p,u as C,f as k,k as w,d as y,Z as A}from"./core-libs-c5XOvvj3.js";import"./ui-heavy-C7pdA4pD.js";const l=t=>typeof t=="string"?t.trim():"",g=t=>Array.isArray(t)?t.map(String).map(c=>c.trim()).filter(Boolean):typeof t=="string"?t.split(/[|/,;]+/).map(c=>c.trim()).filter(Boolean):[],S=t=>{const c={type:["housing","legal","funding","sobriety"].includes(t?.type)?t.type:"sobriety",name:l(t?.name),source:l(t?.source),verified:!!t?.verified,contact:{phone:l(t?.contact?.phone),email:l(t?.contact?.email),url:l(t?.contact?.url||t?.contact?.website)},applyOnline:!!t?.applyOnline,applicationUrl:l(t?.applicationUrl),description:l(t?.description),address:{street:l(t?.address?.street||t?.street),city:l(t?.address?.city||t?.city),state:l(t?.address?.state||t?.state),zip:l(t?.address?.zip||t?.zip)},insurance:g(t?.insurance||t?.insuranceTypes),gender:g(t?.gender||t?.gendersServed),cost:l(t?.cost),tags:g(t?.tags||t?.categories)};return c.city=c.address.city,c.state=c.address.state,c},D=["sobriety","housing","legal","funding"],R=()=>{const[t,c]=o.useState("sobriety"),[h,j]=o.useState([]),[f,u]=o.useState(!1),[r,n]=o.useState({type:"sobriety",name:""}),d=o.useMemo(()=>`assistant_${t}`,[t]),m=async()=>{if(i){u(!0);try{const e=N(p(i,d),C("name")),a=await k(e);j(a.docs.map(x=>({id:x.id,...x.data()})))}catch(e){console.warn("load assistants failed",e)}finally{u(!1)}}};o.useEffect(()=>{m()},[d]);const v=async()=>{if(!i)return;const e=S({...r,type:t}),a=(e.name||`${Date.now()}`).toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"");await w(y(p(i,d),a),e,{merge:!0}),n({type:t,name:""}),await m()},b=async e=>{i&&(await A(y(p(i,d),e)),await m())};return s.jsxs("div",{className:"container max-w-[980px] mx-auto my-8 px-4",children:[s.jsx("h1",{className:"text-2xl font-semibold",children:"Admin Â· Assistants"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Manage assistant listings by type and sync manual corrections."}),s.jsxs("div",{className:"flex gap-3 items-center mb-4",children:[s.jsx("label",{htmlFor:"type",children:"Type"}),s.jsx("select",{id:"type",value:t,onChange:e=>c(e.target.value),children:D.map(e=>s.jsx("option",{value:e,children:e},e))}),s.jsx("button",{type:"button",className:"ghost-btn",onClick:m,disabled:f,children:"Refresh"})]}),s.jsxs("div",{className:"border rounded-md p-4 bg-white/70 backdrop-blur",children:[s.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Add / Edit"}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[s.jsx("input",{value:r.name,onChange:e=>n(a=>({...a,name:e.target.value})),placeholder:"Name"}),s.jsx("input",{value:r.description||"",onChange:e=>n(a=>({...a,description:e.target.value})),placeholder:"Description"}),s.jsx("input",{value:r.contact?.phone||"",onChange:e=>n(a=>({...a,contact:{...a.contact||{},phone:e.target.value}})),placeholder:"Phone"}),s.jsx("input",{value:r.contact?.email||"",onChange:e=>n(a=>({...a,contact:{...a.contact||{},email:e.target.value}})),placeholder:"Email"}),s.jsx("input",{value:r.contact?.url||"",onChange:e=>n(a=>({...a,contact:{...a.contact||{},url:e.target.value}})),placeholder:"Website URL"}),s.jsx("input",{value:r.address?.street||"",onChange:e=>n(a=>({...a,address:{...a.address||{},street:e.target.value}})),placeholder:"Street"}),s.jsx("input",{value:r.address?.city||"",onChange:e=>n(a=>({...a,address:{...a.address||{},city:e.target.value}})),placeholder:"City"}),s.jsx("input",{value:r.address?.state||"",onChange:e=>n(a=>({...a,address:{...a.address||{},state:e.target.value}})),placeholder:"State"}),s.jsx("input",{value:r.address?.zip||"",onChange:e=>n(a=>({...a,address:{...a.address||{},zip:e.target.value}})),placeholder:"ZIP"}),s.jsx("input",{value:r.insurance||"",onChange:e=>n(a=>({...a,insurance:e.target.value})),placeholder:"Insurance (comma / | separated)"}),s.jsx("input",{value:r.gender||"",onChange:e=>n(a=>({...a,gender:e.target.value})),placeholder:"Gender (comma / | separated)"}),s.jsx("input",{value:r.cost||"",onChange:e=>n(a=>({...a,cost:e.target.value})),placeholder:"Cost info"}),s.jsx("input",{value:r.tags||"",onChange:e=>n(a=>({...a,tags:e.target.value})),placeholder:"Tags (comma / | separated)"}),s.jsxs("label",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:!!r.verified,onChange:e=>n(a=>({...a,verified:e.target.checked}))})," Verified"]}),s.jsxs("label",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:!!r.applyOnline,onChange:e=>n(a=>({...a,applyOnline:e.target.checked}))})," Apply online"]}),s.jsx("input",{value:r.applicationUrl||"",onChange:e=>n(a=>({...a,applicationUrl:e.target.value})),placeholder:"Application URL"})]}),s.jsxs("div",{className:"mt-3 flex gap-2",children:[s.jsx("button",{type:"button",className:"ghost-btn",onClick:v,children:"Save"}),s.jsx("button",{type:"button",className:"ghost-btn",onClick:()=>n({type:t,name:""}),children:"Reset"})]})]}),s.jsxs("h2",{className:"text-lg font-semibold mt-6 mb-2",children:[h.length," items"]}),s.jsx("div",{className:"grid md:grid-cols-2 gap-3",children:h.map(e=>s.jsxs("div",{className:"p-card",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold",children:e.name}),s.jsxs("p",{className:"text-sm text-gray-700",children:[e.city,e.state?`, ${e.state}`:""]}),e.verified&&s.jsx("span",{className:"specialty-tag",children:"Verified"}),Array.isArray(e.insurance)&&e.insurance.length>0&&s.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:e.insurance.map(a=>s.jsx("span",{className:"specialty-tag",children:a},a))})]}),s.jsx("button",{type:"button",className:"ghost-btn",onClick:()=>b(e.id),children:"Delete"})]}),s.jsx("p",{className:"mt-2 text-gray-700 text-sm",children:e.description}),e.contact?.url&&s.jsx("a",{href:e.contact.url,className:"ghost-btn mt-2",target:"_blank",rel:"noreferrer",children:"Visit"})]},e.id))})]})};export{R as default};
