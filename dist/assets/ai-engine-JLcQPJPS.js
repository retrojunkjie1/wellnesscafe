import{r as p,j as e,u as Y,a as re}from"./react-vendor-C2vFB_vl.js";import{i as ae,g as oe,a as le,e as ce,o as de,b as W,d as D,q as ue,c as me,w as he,f as pe,s as xe,h as ge,j as fe,k as L,G as be,l as ye,m as je,P,n as Q,S as U,p as ve,C as we,r as Ne}from"./core-libs-c5XOvvj3.js";import{m as E,A as Se}from"./ui-heavy-C7pdA4pD.js";var ot=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ke(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}const _e="modulepreload",Ce=function(t){return"/"+t},$={},Ie=function(r,a,m){let n=Promise.resolve();if(a&&a.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),f=o?.nonce||o?.getAttribute("nonce");n=Promise.allSettled(a.map(x=>{if(x=Ce(x),x in $)return;$[x]=!0;const y=x.endsWith(".css"),h=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${h}`))return;const g=document.createElement("link");if(g.rel=y?"stylesheet":_e,y||(g.as="script"),g.crossOrigin="",g.href=x,f&&g.setAttribute("nonce",f),document.head.appendChild(g),y)return new Promise((d,j)=>{g.addEventListener("load",d),g.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${x}`)))})}))}function c(o){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=o,window.dispatchEvent(f),!f.defaultPrevented)throw o}return n.then(o=>{for(const f of o||[])f.status==="rejected"&&c(f.reason);return r().catch(c)})};var K={exports:{}},Te="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Me=Te,Ae=Me;function J(){}function V(){}V.resetWarningCache=J;var Ee=function(){function t(m,n,c,o,f,x){if(x!==Ae){var y=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw y.name="Invariant Violation",y}}t.isRequired=t;function r(){return t}var a={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:r,element:t,elementType:t,instanceOf:r,node:t,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:V,resetWarningCache:J};return a.PropTypes=a,a};K.exports=Ee();var Re=K.exports;const De=ke(Re),Oe={apiKey:"AIzaSyDT9KZC5cxhQoyEOmMWdufsC-gJCx7O5yA",authDomain:"wellcafeland.firebaseapp.com",projectId:"wellcafeland",storageBucket:"wellcafeland.appspot.com",messagingSenderId:"1022330574843",appId:"1:1022330574843:web:cb618943891f1d6d0e1d5e"},Z=ae(Oe),k=oe(Z),_=le(Z);ce(_).catch(t=>{t.code==="failed-precondition"?console.warn("Firebase persistence failed: Multiple tabs open"):t.code==="unimplemented"&&console.warn("Firebase persistence not supported in this browser")});const X=p.createContext(),Pe=()=>{const t=p.useContext(X);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},Be=({children:t})=>{const[r,a]=p.useState(null),[m,n]=p.useState(!0),c=!!k;p.useEffect(()=>{if(!k){console.warn("Firebase auth is disabled - running in offline mode"),n(!1);return}return de(k,async d=>{if(d)if(_)try{const j=await W(D(_,"users",d.uid)),i=j.exists()?j.data():{};let u=i.role||null,w=[];try{const N=ue(me(_,"providers"),he("ownerUid","==",d.uid)),s=await pe(N);s.empty||(u=u||"provider",w=s.docs.map(l=>l.id))}catch(N){console.warn("provider-role detect failed",N)}a({...d,...i,role:u,providerIds:w})}catch(j){console.warn("Failed to get user document, using basic auth data:",j),a(d)}else a(d);else a(null);n(!1)})},[]);const o=p.useCallback(async(g,d)=>{if(!k)throw new Error("auth-disabled");return xe(k,g,d)},[]),f=p.useCallback(async(g,d,j={})=>{if(!k)throw new Error("auth-disabled");const i=await ge(k,g,d);try{const u={url:`${window.location.origin}/dashboard`,handleCodeInApp:!0};await fe(i.user,u),console.log("âœ… Verification email sent successfully to:",g)}catch(u){if(console.error("âŒ Email verification send failed:",u),u.code==="auth/too-many-requests")throw new Error("Too many requests. Please wait a few minutes and check your email.");if(u.code==="auth/invalid-email")throw new Error("Invalid email address. Please check and try again.");if(u.code==="auth/unauthorized-domain")throw new Error("Email verification is not configured for this domain. Please contact support.");console.warn("Non-fatal: Email verification may not have been sent")}return _&&await L(D(_,"users",i.user.uid),{email:i.user.email,createdAt:new Date,emailVerificationSent:!0,emailVerificationSentAt:new Date().toISOString(),...j}),i},[]),x=p.useCallback(async()=>{if(!k)throw new Error("auth-disabled");const g=new be,d=await ye(k,g);return _&&((await W(D(_,"users",d.user.uid))).exists()||await L(D(_,"users",d.user.uid),{email:d.user.email,displayName:d.user.displayName,photoURL:d.user.photoURL,createdAt:new Date})),d},[]),y=p.useCallback(async()=>{if(k)return je(k)},[]),h=p.useMemo(()=>({user:r,login:o,register:f,loginWithGoogle:x,logout:y,loading:m,authEnabled:c}),[r,o,f,x,y,m,c]);return e.jsx(X.Provider,{value:h,children:!m&&t})};Be.propTypes={children:De.node.isRequired};const F={sleep_reset:{label:"Sleep Reset",description:"Wind down and prepare for restorative sleep",icon:"ðŸŒ™",color:"#6366f1",defaultDuration:15},calm_anxiety:{label:"Calm Anxiety",description:"Regulate your nervous system and ease worry",icon:"ðŸŒŠ",color:"#0ea5e9",defaultDuration:10},craving_wave:{label:"Craving Wave",description:"Ride the wave of craving without acting on it",icon:"ðŸŒŠ",color:"#f59e0b",defaultDuration:8},grounding:{label:"Grounding",description:"Return to present moment awareness",icon:"ðŸŒ±",color:"#10b981",defaultDuration:5},morning_reset:{label:"Morning Reset",description:"Start your day with intention and energy",icon:"â˜€ï¸",color:"#f97316",defaultDuration:12},evening_winddown:{label:"Evening Winddown",description:"Release the day and transition to rest",icon:"ðŸŒ†",color:"#8b5cf6",defaultDuration:15},body_awareness:{label:"Body Awareness",description:"Connect with physical sensations and movement",icon:"ðŸ’«",color:"#ec4899",defaultDuration:20},custom:{label:"Custom Session",description:"Tailored to your specific needs",icon:"âœ¨",color:"#a855f7",defaultDuration:15}},qe={check_in:{label:"Check-In",icon:"ðŸ“‹",color:"#64748b"},breath:{label:"Breathwork",icon:"ðŸ«",color:"#0ea5e9"},yoga:{label:"Movement",icon:"ðŸ§˜",color:"#ec4899"},meditation:{label:"Meditation",icon:"ðŸ§˜â€â™€ï¸",color:"#8b5cf6"},journaling:{label:"Journaling",icon:"âœï¸",color:"#f59e0b"},education:{label:"Learn",icon:"ðŸ“š",color:"#10b981"},reflection:{label:"Reflection",icon:"ðŸ’­",color:"#6366f1"},media:{label:"Media",icon:"ðŸŽ¬",color:"#ec4899"},provider_suggestion:{label:"Get Support",icon:"ðŸ¤",color:"#f97316"}};function ee(){const t=Date.now(),r=Math.random().toString(36).substring(2,8);return`session_${t}_${r}`}function Ue(t){const r=Math.random().toString(36).substring(2,6);return`step_${t}_${r}`}const G={quick:{label:"Quick Resets",duration:"5-10 min",color:"#f59e0b"},morning:{label:"Morning Rituals",duration:"10-20 min",color:"#3b82f6"},evening:{label:"Evening Wind-Down",duration:"15-30 min",color:"#8b5cf6"},crisis:{label:"Crisis Support",duration:"5-15 min",color:"#ef4444"},focus:{label:"Focus & Clarity",duration:"10-25 min",color:"#10b981"}},z=[{id:"template_anxiety_quick",userId:"template",intent:"calm_anxiety",title:"5-Minute Anxiety Reset",aiSummary:"Quick nervous system regulation using breathing and grounding.",totalMinutes:5,category:"quick",difficulty:"beginner",tags:["breathing","quick","anxiety"],createdAtIso:new Date().toISOString(),steps:[{id:"step_1",kind:"check_in",order:1,title:"Quick Check-In",questions:[{id:"q_anxiety",label:"How anxious do you feel right now?",type:"scale",scaleMin:0,scaleMax:10}]},{id:"step_2",kind:"breath",order:2,title:"Coherence Breathing",durationSec:240,pattern:{inhale:4,exhale:6},style:"coherence",coaching:"Slow, steady breaths to calm your nervous system."},{id:"step_3",kind:"check_in",order:3,title:"Quick Check-Out",questions:[{id:"q_anxiety_after",label:"How do you feel now?",type:"scale",scaleMin:0,scaleMax:10}]}],followUpSuggestions:["Practice this twice daily for best results","Try the 10-minute version for deeper calm"]},{id:"template_sleep_quick",userId:"template",intent:"sleep_reset",title:"Quick Sleep Prep",aiSummary:"Wind down fast with gentle breathing and body awareness.",totalMinutes:8,category:"quick",difficulty:"beginner",tags:["sleep","bedtime","relaxation"],createdAtIso:new Date().toISOString(),steps:[{id:"step_1",kind:"breath",order:1,title:"4-7-8 Breathing",durationSec:180,pattern:{inhale:4,hold:7,exhale:8},style:"sleep",coaching:"This pattern naturally induces drowsiness."},{id:"step_2",kind:"meditation",order:2,title:"Body Scan",durationSec:300,style:"body_scan",script:"Starting with your toes, notice any sensations. Release any tension. Move slowly up through your feet, ankles, calves... Let each part of your body sink into rest."}],followUpSuggestions:["Keep your bedroom cool and dark","Avoid screens 30 minutes before this session"]},{id:"template_morning_energy",userId:"template",intent:"morning_reset",title:"Morning Energy Boost",aiSummary:"Start your day with intention, movement, and mental clarity.",totalMinutes:12,category:"morning",difficulty:"beginner",tags:["morning","energy","intention"],createdAtIso:new Date().toISOString(),steps:[{id:"step_1",kind:"check_in",order:1,title:"Morning Check-In",questions:[{id:"q_energy",label:"How's your energy level this morning?",type:"scale",scaleMin:0,scaleMax:10},{id:"q_intention",label:"What's one intention for today?",type:"text",placeholder:"I intend to..."}]},{id:"step_2",kind:"breath",order:2,title:"Energizing Breath",durationSec:180,pattern:{inhale:3,exhale:3},style:"energizing",coaching:"Quick, rhythmic breaths to wake up your system."},{id:"step_3",kind:"meditation",order:3,title:"Gratitude Moment",durationSec:240,style:"gratitude",script:"Bring to mind three things you're grateful for today. They can be simple: warm coffee, a comfortable bed, another day. Let the feeling of gratitude fill your chest."},{id:"step_4",kind:"check_in",order:4,title:"Set Your Tone",questions:[{id:"q_ready",label:"How ready do you feel for your day?",type:"scale",scaleMin:0,scaleMax:10}]}],followUpSuggestions:["Add 5 minutes of stretching before this session","Journal your intention for deeper clarity"]},{id:"template_evening_release",userId:"template",intent:"evening_winddown",title:"Evening Release & Reflect",aiSummary:"Let go of the day's stress and transition into rest mode.",totalMinutes:15,category:"evening",difficulty:"beginner",tags:["evening","reflection","stress-relief"],createdAtIso:new Date().toISOString(),steps:[{id:"step_1",kind:"check_in",order:1,title:"Day Review",questions:[{id:"q_stress",label:"How stressed do you feel after today?",type:"scale",scaleMin:0,scaleMax:10},{id:"q_win",label:"What was one win from today?",type:"text",placeholder:"Even a small win counts..."}]},{id:"step_2",kind:"breath",order:2,title:"Releasing Breath",durationSec:300,pattern:{inhale:4,hold:2,exhale:6},style:"calm",coaching:"With each exhale, imagine releasing tension from your day."},{id:"step_3",kind:"meditation",order:3,title:"Loving Kindness",durationSec:360,style:"loving_kindness",script:"May I be peaceful. May I be safe. May I be healthy. May I rest easy. Repeat these phrases, letting the words settle into your heart. You deserve rest."},{id:"step_4",kind:"check_in",order:4,title:"Evening Reflection",questions:[{id:"q_peaceful",label:"How peaceful do you feel now?",type:"scale",scaleMin:0,scaleMax:10}]}],followUpSuggestions:["Try reading for 15 minutes after this","Keep a gratitude journal by your bed"]},{id:"template_crisis_grounding",userId:"template",intent:"grounding",title:"Emergency Grounding",aiSummary:"Rapid stabilization using proven grounding techniques.",totalMinutes:7,category:"crisis",difficulty:"beginner",tags:["crisis","grounding","panic","emergency"],createdAtIso:new Date().toISOString(),steps:[{id:"step_1",kind:"check_in",order:1,title:"Immediate Check",questions:[{id:"q_distress",label:"How distressed are you feeling right now?",type:"scale",scaleMin:0,scaleMax:10}]},{id:"step_2",kind:"breath",order:2,title:"Box Breathing",durationSec:240,pattern:{inhale:4,hold:4,exhale:4,hold:4},style:"box",coaching:"Follow the square pattern. This is what Navy SEALs use."},{id:"step_3",kind:"meditation",order:3,title:"5-4-3-2-1 Grounding",durationSec:180,style:"grounding",script:"Name 5 things you can see. 4 things you can touch. 3 things you can hear. 2 things you can smell. 1 thing you can taste. You are here. You are safe. You are present."}],followUpSuggestions:["Call your support person if distress remains high","Consider professional help if crises are frequent"]},{id:"template_craving_wave",userId:"template",intent:"craving_wave",title:"Urge Surfing Session",aiSummary:"Ride the craving wave without acting on it.",totalMinutes:10,category:"crisis",difficulty:"intermediate",tags:["cravings","urges","recovery","mindfulness"],createdAtIso:new Date().toISOString(),steps:[{id:"step_1",kind:"check_in",order:1,title:"Craving Assessment",questions:[{id:"q_urge",label:"How strong is your urge right now?",type:"scale",scaleMin:0,scaleMax:10},{id:"q_trigger",label:"What triggered this urge?",type:"text",placeholder:"Person, place, feeling..."}]},{id:"step_2",kind:"breath",order:2,title:"Stabilizing Breath",durationSec:180,pattern:{inhale:4,exhale:6},style:"calm",coaching:"Ground yourself before surfing the urge."},{id:"step_3",kind:"meditation",order:3,title:"Urge Surfing",durationSec:300,style:"mindfulness",script:"Notice the urge like a wave. Don't fight it. Don't feed it. Just watch it. Where do you feel it in your body? What thoughts come with it? Observe with curiosity. The wave will crest and fall. Urges always pass."},{id:"step_4",kind:"check_in",order:4,title:"Post-Wave Check",questions:[{id:"q_urge_after",label:"How strong is the urge now?",type:"scale",scaleMin:0,scaleMax:10}]}],followUpSuggestions:["Text your accountability partner","Distract with a healthy activity for 20 minutes","Track this urge in your journal"]},{id:"template_focus_prep",userId:"template",intent:"custom",title:"Deep Work Preparation",aiSummary:"Clear your mind and prime focus for productive work.",totalMinutes:10,category:"focus",difficulty:"beginner",tags:["focus","productivity","clarity","work"],createdAtIso:new Date().toISOString(),steps:[{id:"step_1",kind:"check_in",order:1,title:"Pre-Work Check",questions:[{id:"q_focus",label:"How focused do you feel right now?",type:"scale",scaleMin:0,scaleMax:10},{id:"q_goal",label:"What's your main goal for this work session?",type:"text",placeholder:"I want to accomplish..."}]},{id:"step_2",kind:"breath",order:2,title:"Clarity Breath",durationSec:180,pattern:{inhale:5,exhale:5},style:"coherence",coaching:"Balanced breathing brings mental clarity."},{id:"step_3",kind:"meditation",order:3,title:"Intention Setting",durationSec:240,style:"visualization",script:"Visualize yourself working with complete focus. See yourself moving through tasks with ease. Feel the satisfaction of progress. Set the intention: 'I am focused and productive.'"}],followUpSuggestions:["Use the Pomodoro technique (25 min work, 5 min break)","Repeat this before important meetings or creative work"]}],ze=t=>z.find(r=>r.id===t),We=(t,r)=>{const a=ze(t);return a?{...a,id:ee(),userId:r,createdAtIso:new Date().toISOString(),isFromTemplate:!0,templateId:t}:null},Le="https://us-central1-wellnesscafelanding.cloudfunctions.net";async function te(t){const r=await fetch(`${Le}/aiSession`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok)throw new Error(`AI Session Error: ${r.status}`);return r.json()}const $e=Object.freeze(Object.defineProperty({__proto__:null,callAISession:te},Symbol.toStringTag,{value:"Module"}));async function Fe({userId:t,mood:r,timeOfDay:a,intentGroup:m}={}){try{const n=await te({mode:"templates",count:6,userId:t||"demo_user",mood:r||"mixed",intentGroup:m||"quick_resets"});return n.templates&&Array.isArray(n.templates)?n.templates:n.sessionPlan?.templates?n.sessionPlan.templates:[]}catch(n){return console.error("AI Template Error:",n),[]}}const Ge=({template:t,onStart:r})=>{const a=Array.isArray(t.steps)?t.steps.length:t.steps||3,m=t.minutes||t.totalMinutes||5;return e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(255,255,255,0.7) 0%, rgba(255,255,255,0.3) 100%)",backdropFilter:"blur(12px)",WebkitBackdropFilter:"blur(12px)",border:"1px solid rgba(255,255,255,0.4)",borderRadius:"1rem",padding:"1.5rem",boxShadow:"0 10px 25px rgba(0,0,0,0.2)",transition:"all 0.3s ease",cursor:"pointer",width:"100%"},onMouseEnter:n=>{n.currentTarget.style.boxShadow="0 15px 35px rgba(0,0,0,0.3)",n.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:n=>{n.currentTarget.style.boxShadow="0 10px 25px rgba(0,0,0,0.2)",n.currentTarget.style.transform="translateY(0)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.75rem"},children:[e.jsx("span",{style:{fontSize:"1.5rem"},children:t.icon||"âœ¨"}),e.jsx("span",{style:{fontSize:"0.75rem",fontWeight:"600",color:"#9333ea",textTransform:"uppercase",letterSpacing:"0.05em"},children:"AI Generated"})]}),e.jsx("h3",{style:{fontSize:"1.125rem",fontWeight:"bold",color:"#0f172a",marginBottom:"0.5rem",margin:0},children:t.title||t.tagline||"Wellness Session"}),e.jsx("p",{style:{fontSize:"0.875rem",color:"#475569",marginBottom:"1rem",lineHeight:"1.5",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:t.summary||t.aiSummary||"A personalized wellness session designed for you."}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"0.75rem",color:"#64748b",marginBottom:"1rem"},children:[e.jsxs("span",{children:[a," steps"]}),e.jsxs("span",{children:["~",m," min"]})]}),e.jsx("button",{onClick:()=>r(t),style:{width:"100%",padding:"0.5rem 1rem",backgroundColor:"#9333ea",color:"white",borderRadius:"0.5rem",fontWeight:"500",border:"none",cursor:"pointer",transition:"background-color 0.2s"},onMouseEnter:n=>n.target.style.backgroundColor="#7e22ce",onMouseLeave:n=>n.target.style.backgroundColor="#9333ea",children:"Start Session"})]})},He={check_in:"awareness",breath:"regulation",meditation:"processing",reflection:"reflection",movement:"action",journaling:"processing",intention:"identification"},Ye=t=>He[t]||"awareness",O={CHECK_IN:"check_in",check_in:"check_in",checkin:"check_in",BREATH:"breath",breath:"breath",BREATHWORK:"breath",MEDITATION:"meditation",meditation:"meditation",REFLECTION:"reflection",reflection:"reflection",MOVEMENT:"movement",movement:"movement",JOURNAL:"journaling",journaling:"journaling",INTENTION:"intention",intention:"intention"},Qe=t=>{if(!t)return"check_in";const r=String(t);return O[r]?O[r]:O[r.toUpperCase()]?O[r.toUpperCase()]:"check_in"},Ke=t=>{if(!t)return null;const r={id:t.id||ee(),userId:t.userId||"ai_generated",intent:t.intent||"generic",title:t.title||"AI Wellness Session",aiSummary:t.aiSummary||t.summary||"",totalMinutes:t.totalMinutes||t.estimatedDuration||5,createdAtIso:t.createdAtIso||new Date().toISOString(),followUpSuggestions:t.followUpSuggestions||t.suggestions||[]},a=(t.steps||[]).map((m,n)=>{const c=Qe(m.kind||m.type);return{...m,id:m.id||Ue(n+1),kind:c,order:m.order||n+1,masterCategory:Ye(c)}});return{...r,steps:a}},Je={check_in:"ðŸ“",breath:"ðŸ«",meditation:"ðŸ§˜",journal:"âœï¸",affirmation:"ðŸ’«",visualization:"ðŸ”®",movement:"ðŸƒ",gratitude:"ðŸ™"},H={quick:"âš¡",morning:"â˜€ï¸",evening:"ðŸŒ™",crisis:"ðŸ†˜",focus:"ðŸŽ¯"},Ve=()=>{const t=Y(),{currentUser:r}=Pe(),[a,m]=p.useState("all"),[n,c]=p.useState(!1),[o,f]=p.useState([]),[x,y]=p.useState(!0),[h,g]=p.useState(null);p.useEffect(()=>{async function s(){try{y(!0);const l=await Fe({userId:r?.uid||"demo_user",mood:"neutral",timeOfDay:"any",intentGroup:"quick_resets"});console.log("AI Templates loaded:",l),f(l||[])}catch(l){console.error("Failed to load AI templates:",l),f([])}finally{y(!1)}}s()},[r]);const d=p.useMemo(()=>a==="all"?z:z.filter(s=>s.category===a),[a]);console.log("ðŸ“‹ Filtered templates:",d.length,d);const j=async()=>{try{console.log("ðŸ§ª Testing AI Session endpoint...");const{callAISession:s}=await Ie(async()=>{const{callAISession:b}=await Promise.resolve().then(()=>$e);return{callAISession:b}},void 0),l=await s({mode:"templates",userId:"test",mood:"calm",count:6});return console.log("âœ… AI Session Response:",l),g(l),l}catch(s){return console.error("âŒ AI Session Test Error:",s),g({error:s.message}),null}},i=s=>{if(!r){t("/login",{state:{from:"/sessions/templates",message:"Please login to start a session"}});return}c(!0);let l;if(s.isAi||!s.id||s.summary||s.id?.startsWith("ai-")){let b=s.steps||[];typeof s.steps=="number"&&(b=[{kind:"check_in",title:"Check In",order:1},{kind:"breath",title:"Breathwork",order:2},{kind:"meditation",title:"Meditation",order:3}].slice(0,s.steps)),l=Ke({...s,userId:r.uid,title:s.title,aiSummary:s.summary||s.title,totalMinutes:s.minutes||s.totalMinutes||5,steps:b})}else l=We(s.id,r.uid);if(!l){console.error("Failed to create session from template"),c(!1);return}setTimeout(()=>{t("/sessions/active",{state:{sessionPlan:l}}),c(!1)},300)},u=(s,l)=>{const b=a===s;return e.jsxs("button",{className:`filter-button ${b?"active":""}`,onClick:()=>m(s),"aria-pressed":b,children:[e.jsx("span",{className:"filter-icon",children:H[s]||"ðŸ“‹"}),l.label]},s)},w=s=>{console.log("ðŸŽ¨ Rendering template card:",s.id,s.title);const l=G[s.category];return e.jsxs("div",{className:"template-card",children:[e.jsxs("div",{className:"template-card-header",children:[e.jsxs("span",{className:`template-category-badge ${s.category}`,children:[e.jsx("span",{children:H[s.category]}),e.jsx("span",{children:l?.label||s.category})]}),e.jsx("span",{className:"template-difficulty",children:s.difficulty})]}),e.jsx("div",{className:"template-icon",children:N(s)}),e.jsx("h3",{className:"template-title",children:s.title}),e.jsx("p",{className:"template-description",children:s.aiSummary}),e.jsxs("div",{className:"template-stats",children:[e.jsxs("div",{className:"template-stat",children:[e.jsx("span",{className:"template-stat-icon",children:"â±ï¸"}),e.jsxs("span",{children:[s.totalMinutes," min"]})]}),e.jsxs("div",{className:"template-stat",children:[e.jsx("span",{className:"template-stat-icon",children:"ðŸ“Š"}),e.jsxs("span",{children:[s.steps.length," steps"]})]})]}),e.jsx("div",{className:"template-steps-preview",children:s.steps.map((b,v)=>e.jsx("div",{className:"step-icon",title:b.title||b.kind,children:Je[b.kind]||"â€¢"},v))}),e.jsxs("button",{className:"template-start-button",onClick:()=>i(s),disabled:n,children:[e.jsx("span",{children:"Start Session"}),e.jsx("span",{children:"â†’"})]})]},s.id)},N=s=>({calm_anxiety:"ðŸ˜Œ",sleep_reset:"ðŸ˜´",morning_reset:"ðŸŒ…",evening_winddown:"ðŸŒ†",grounding:"ðŸŒ¿",craving_wave:"ðŸŒŠ",custom:"âœ¨"})[s.intent]||"ðŸ”®";return e.jsxs("div",{className:"session-templates-page",children:[e.jsxs("div",{className:"templates-hero",children:[e.jsx("h1",{className:"templates-hero-title",children:"Wellness Session Templates"}),e.jsx("p",{className:"templates-hero-subtitle",children:"Pre-built guided sessions ready to start"}),e.jsx("p",{className:"templates-hero-description",children:"Choose from expertly crafted wellness routines designed for anxiety relief, better sleep, morning energy, crisis support, and focused productivity."})]}),e.jsxs("div",{className:"templates-filters",children:[e.jsxs("button",{className:`filter-button ${a==="all"?"active":""}`,onClick:()=>m("all"),"aria-pressed":a==="all",children:[e.jsx("span",{className:"filter-icon",children:"ðŸ“‹"}),"All Templates"]}),Object.entries(G).map(([s,l])=>u(s,l))]}),e.jsxs("div",{className:"templates-count",children:[e.jsx("strong",{children:d.length})," ",d.length===1?"template":"templates"," available"]}),d.length>0?e.jsx("div",{className:"templates-grid",children:d.map(s=>w(s))}):e.jsxs("div",{className:"templates-empty",children:[e.jsx("div",{className:"templates-empty-icon",children:"ðŸ˜”"}),e.jsx("div",{className:"templates-empty-text",children:"No templates found"}),e.jsx("div",{className:"templates-empty-subtext",children:"Try selecting a different category"})]}),e.jsxs("div",{style:{marginTop:"4rem",paddingTop:"2rem",borderTop:"1px solid rgba(255,255,255,0.1)",width:"100%"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"space-between",gap:"1rem",marginBottom:"2rem"},className:"sm:flex-row sm:items-center",children:[e.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#f1f5f9",margin:0,textShadow:"0 2px 4px rgba(0,0,0,0.3)"},className:"sm:text-2xl",children:"âœ¨ AI-Generated Sessions For You"}),e.jsx("button",{onClick:j,style:{padding:"0.5rem 1rem",backgroundColor:"#9333ea",color:"white",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"500",border:"none",cursor:"pointer",whiteSpace:"nowrap",transition:"background-color 0.2s"},onMouseEnter:s=>s.target.style.backgroundColor="#7e22ce",onMouseLeave:s=>s.target.style.backgroundColor="#9333ea",children:"ðŸ§ª Test Endpoint"})]}),h&&e.jsxs("div",{className:"mb-6 p-6 bg-gradient-to-br from-purple-50 to-indigo-50 border border-purple-200 rounded-xl shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-purple-900",children:"ðŸ§ª Test Results"}),e.jsx("button",{onClick:()=>g(null),className:"text-purple-600 hover:text-purple-800 text-sm",children:"âœ• Close"})]}),h.error?e.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx("div",{className:"text-red-800 font-semibold mb-2",children:"âŒ Error:"}),e.jsx("div",{className:"text-red-700 text-sm",children:h.error})]}):e.jsxs("div",{className:"space-y-4",children:[h.sessionPlan?.templates&&e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold text-purple-800 mb-2",children:["âœ… Success! Found ",h.sessionPlan.templates.length," templates"]}),e.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3 mt-3",children:h.sessionPlan.templates.map((s,l)=>e.jsxs("div",{className:"p-4 bg-white/80 backdrop-blur-sm border border-purple-200 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-2xl",children:s.icon||"âœ¨"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-slate-900 text-sm",children:s.title}),e.jsx("div",{className:"text-xs text-purple-600 font-semibold",children:"AI Generated"})]})]}),e.jsx("p",{className:"text-xs text-slate-600 mb-2 line-clamp-2",children:s.summary}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500",children:[e.jsxs("span",{children:[s.steps||0," steps"]}),e.jsxs("span",{children:["~",s.minutes||0," min"]}),e.jsx("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-700 rounded",children:s.level||"All Levels"})]})]},s.id||l))})]}),e.jsxs("details",{className:"mt-4",children:[e.jsx("summary",{className:"cursor-pointer text-sm font-semibold text-purple-700 hover:text-purple-900 mb-2",children:"ðŸ“‹ View Raw JSON"}),e.jsx("div",{className:"mt-2 p-4 bg-slate-900 rounded-lg overflow-auto max-h-96",children:e.jsx("pre",{className:"text-xs text-green-400 font-mono",children:JSON.stringify(h,null,2)})})]})]})]}),x&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600 mb-3"}),e.jsx("div",{className:"text-slate-300 text-sm",children:"Generating personalized sessionsâ€¦"})]}),!x&&o.length===0&&!h&&e.jsxs("div",{className:"text-center py-8 px-4 bg-slate-800/50 rounded-xl border border-slate-700",children:[e.jsx("div",{className:"text-slate-400 text-sm mb-2",children:"No AI sessions available right now."}),e.jsx("button",{onClick:j,className:"mt-3 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg text-sm font-medium transition-colors",children:"Try Loading Templates"})]}),!x&&o.length>0&&e.jsx("div",{className:"grid gap-6 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3",children:o.map(s=>e.jsx(Ge,{template:s,onStart:i},s.id||s.title||Math.random()))})]}),e.jsxs("div",{className:"templates-info-section",children:[e.jsx("h2",{className:"templates-info-title",children:"Why Use Session Templates?"}),e.jsxs("div",{className:"templates-info-content",children:[e.jsx("p",{children:"Our professionally designed session templates provide structured wellness experiences that you can start instantly. Each template combines proven techniques from mindfulness, breathwork, and cognitive behavioral therapy."}),e.jsxs("ul",{className:"templates-info-list",children:[e.jsx("li",{children:"No setup required - just click and start"}),e.jsx("li",{children:"Evidence-based practices for maximum benefit"}),e.jsx("li",{children:"Perfect for building consistent wellness habits"}),e.jsx("li",{children:"Guided step-by-step through each session"}),e.jsx("li",{children:"Track your progress over time"})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Pro Tip:"})," Try different templates to discover which techniques work best for you. Many users find that morning and evening routines create powerful bookends for their day."]})]})]}),n&&e.jsx("div",{className:"templates-loading",style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:e.jsx("div",{className:"templates-loading-spinner"})})]})},lt=Object.freeze(Object.defineProperty({__proto__:null,default:Ve},Symbol.toStringTag,{value:"Module"})),Ze=({step:t,onComplete:r,onSkip:a,metadata:m})=>{const[n,c]=p.useState({}),[o,f]=p.useState(0),x=t.questions[o],y=o===t.questions.length-1;t.questions.every(i=>n[i.id]!==void 0);const h=(i,u)=>{c(w=>({...w,[i]:u}))},g=()=>{y?r({checkInResponses:n}):f(i=>i+1)},d=()=>{o>0&&f(i=>i-1)},j=i=>{const u=n[i.id];switch(i.type){case"scale":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm text-slate-500",children:i.scaleMin||0}),e.jsx("span",{className:"text-sm text-slate-500",children:i.scaleMax||10})]}),e.jsx("input",{type:"range",min:i.scaleMin||0,max:i.scaleMax||10,value:u||Math.floor((i.scaleMax||10)/2),onChange:w=>h(i.id,parseInt(w.target.value)),className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-indigo-600"}),e.jsx("div",{className:"text-center",children:e.jsx("span",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-indigo-100 text-indigo-600 text-2xl font-bold",children:u!==void 0?u:Math.floor((i.scaleMax||10)/2)})})]});case"text":return e.jsx("textarea",{value:u||"",onChange:w=>h(i.id,w.target.value),placeholder:"Type your response...",rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 resize-none"});case"multi":return e.jsx("div",{className:"text-sm text-slate-500 p-4 bg-slate-50 rounded-lg",children:"Multi-select option coming soon. For now, please use text input."});default:return e.jsxs("div",{className:"text-sm text-red-500",children:["Unsupported question type: ",i.type]})}};return e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"text-4xl mb-3",children:m.icon}),e.jsx("h2",{className:"text-2xl font-semibold text-slate-800 mb-2",children:t.title}),t.description&&e.jsx("p",{className:"text-slate-600",children:t.description})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-slate-500 mb-2",children:[e.jsxs("span",{children:["Question ",o+1," of ",t.questions.length]}),e.jsxs("span",{children:[Math.round((o+1)/t.questions.length*100),"%"]})]}),e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2",children:e.jsx("div",{className:"bg-indigo-600 h-2 rounded-full transition-all duration-300",style:{width:`${(o+1)/t.questions.length*100}%`}})})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl p-6 shadow-sm mb-6",children:[e.jsx("label",{className:"block text-lg font-medium text-slate-700 mb-4",children:x.label}),j(x)]}),e.jsxs("div",{className:"flex gap-3 justify-between",children:[e.jsxs("div",{className:"flex gap-2",children:[o>0&&e.jsx("button",{onClick:d,className:"px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg transition-colors",children:"â† Back"}),a&&e.jsx("button",{onClick:a,className:"px-4 py-2 text-slate-500 hover:text-slate-700 transition-colors",children:"Skip Step"})]}),e.jsx("button",{onClick:g,disabled:n[x.id]===void 0,className:`px-6 py-2 rounded-lg font-medium transition-colors ${n[x.id]!==void 0?"bg-indigo-600 hover:bg-indigo-700 text-white":"bg-slate-200 text-slate-400 cursor-not-allowed"}`,children:y?"Complete Check-In":"Next â†’"})]}),Object.keys(n).length>1&&e.jsxs("div",{className:"mt-6 p-4 bg-slate-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-slate-700 mb-2",children:"Your Responses"}),e.jsx("div",{className:"space-y-1",children:t.questions.map(i=>{const u=n[i.id];return u===void 0?null:e.jsxs("div",{className:"text-xs text-slate-600",children:[e.jsxs("span",{className:"font-medium",children:[i.label,":"]})," ",e.jsx("span",{children:i.type==="scale"?`${u}/${i.scaleMax||10}`:typeof u=="string"&&u.length>50?u.substring(0,50)+"...":u})]},i.id)})})]})]})},Xe=({step:t,onComplete:r,onSkip:a,metadata:m})=>{const[n,c]=p.useState(!1),[o,f]=p.useState("ready"),[x,y]=p.useState(0),[h,g]=p.useState(0),d=p.useRef(null),j=p.useRef(null),{pattern:i,durationSec:u,coaching:w}=t,N=u?Math.floor(u/s()):5;function s(){return i.inhale+(i.holdTop||0)+i.exhale+(i.holdBottom||0)}const l=S=>{const M=Math.floor(S/60),R=S%60;return`${M}:${R.toString().padStart(2,"0")}`},b=S=>{switch(S){case"ready":case"inhale":return i.holdTop?"hold_top":"exhale";case"hold_top":return"exhale";case"exhale":return i.holdBottom?"hold_bottom":"inhale";case"hold_bottom":return"inhale";default:return"inhale"}},v=S=>{switch(S){case"inhale":return i.inhale;case"hold_top":return i.holdTop||0;case"exhale":return i.exhale;case"hold_bottom":return i.holdBottom||0;default:return 0}},I=S=>{switch(S){case"ready":return"Ready to begin";case"inhale":return"Breathe in";case"hold_top":return"Hold";case"exhale":return"Breathe out";case"hold_bottom":return"Hold";default:return""}},T=()=>n?o==="inhale"?1.5:o==="exhale"?.7:1:1,C=()=>{switch(o){case"inhale":return"#6366f1";case"exhale":return"#10b981";case"hold_top":case"hold_bottom":return"#8b5cf6";default:return"#64748b"}},B=()=>{c(!0),f("inhale"),g(0),y(0),j.current=Date.now()},se=()=>{c(!1),clearTimeout(d.current)},ne=()=>{c(!0)},q=()=>{c(!1),clearTimeout(d.current),r({breathingData:{cyclesCompleted:x,durationSeconds:h,pattern:t.pattern}})};p.useEffect(()=>{if(!n||o==="ready")return;const S=v(o)*1e3;return d.current=setTimeout(()=>{const M=b(o);if(o===(i.holdBottom?"hold_bottom":"exhale")&&M==="inhale"){const R=x+1;if(y(R),R>=N){q();return}}f(M)},S),()=>clearTimeout(d.current)},[n,o,i,x,N]),p.useEffect(()=>{if(!n)return;const S=setInterval(()=>{g(M=>M+1)},1e3);return()=>clearInterval(S)},[n]),p.useEffect(()=>{u&&h>=u&&n&&q()},[h,u,n]);const ie=u?h/u*100:x/N*100;return e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"text-4xl mb-3",children:m.icon}),e.jsx("h2",{className:"text-2xl font-semibold text-slate-800 mb-2",children:t.title}),t.description&&e.jsx("p",{className:"text-slate-600 mb-3",children:t.description}),w&&e.jsxs("p",{className:"text-sm text-indigo-600 italic max-w-md mx-auto",children:['"',w,'"']})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between text-sm text-slate-600 mb-2",children:[e.jsxs("span",{children:[x," / ",N," cycles"]}),e.jsx("span",{children:l(h)})]}),e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2",children:e.jsx("div",{className:"bg-indigo-600 h-2 rounded-full transition-all duration-500",style:{width:`${Math.min(ie,100)}%`}})})]}),e.jsxs("div",{className:"relative flex items-center justify-center h-80 mb-6",children:[e.jsx(E.div,{animate:{scale:T(),backgroundColor:C(),boxShadow:n?`0 0 80px ${C()}66`:"0 0 20px rgba(0,0,0,0.1)"},transition:{duration:v(o),ease:"easeInOut"},className:"w-48 h-48 rounded-full flex items-center justify-center text-white font-semibold text-xl",children:I(o).toUpperCase()}),n&&e.jsx(E.div,{className:"absolute inset-0 flex items-center justify-center",animate:{scale:[1,1.2,1],opacity:[.3,.6,.3]},transition:{duration:v(o),ease:"easeInOut",repeat:1/0},children:e.jsx("div",{className:"w-48 h-48 rounded-full border-2",style:{borderColor:C()}})})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-4 mb-6 grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Inhale:"}),e.jsxs("span",{className:"ml-2 font-semibold",children:[i.inhale,"s"]})]}),i.holdTop>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Hold:"}),e.jsxs("span",{className:"ml-2 font-semibold",children:[i.holdTop,"s"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Exhale:"}),e.jsxs("span",{className:"ml-2 font-semibold",children:[i.exhale,"s"]})]}),i.holdBottom>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Hold:"}),e.jsxs("span",{className:"ml-2 font-semibold",children:[i.holdBottom,"s"]})]})]}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[!n&&o==="ready"?e.jsxs("button",{onClick:B,className:"flex items-center gap-2 px-6 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors",children:[e.jsx(P,{size:20}),"Start Breathing"]}):n?e.jsxs("button",{onClick:se,className:"flex items-center gap-2 px-6 py-3 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-lg font-medium transition-colors",children:[e.jsx(Q,{size:20}),"Pause"]}):e.jsxs("button",{onClick:ne,className:"flex items-center gap-2 px-6 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors",children:[e.jsx(P,{size:20}),"Resume"]}),n&&e.jsxs("button",{onClick:q,className:"flex items-center gap-2 px-6 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-medium transition-colors",children:[e.jsx(U,{size:20}),"Complete"]}),a&&!n&&o==="ready"&&e.jsx("button",{onClick:a,className:"px-4 py-3 text-slate-500 hover:text-slate-700 transition-colors",children:"Skip Step"})]})]})},et=({step:t,onComplete:r,onSkip:a,metadata:m})=>{const[n,c]=p.useState(!1),[o,f]=p.useState(0),[x,y]=p.useState(!0),h=p.useRef(null),{script:g,durationSec:d,style:j}=t,i=d||300,u=T=>{const C=Math.floor(T/60),B=T%60;return`${C}:${B.toString().padStart(2,"0")}`},w=()=>{c(!0),f(0)},N=()=>{c(!1)},s=()=>{c(!0)},l=()=>{c(!1),h.current&&clearInterval(h.current),r({meditationData:{durationSeconds:o,style:t.style,completed:o>=i}})};p.useEffect(()=>{if(!n){h.current&&clearInterval(h.current);return}return h.current=setInterval(()=>{f(T=>{const C=T+1;return C>=i?(l(),T):C})},1e3),()=>{h.current&&clearInterval(h.current)}},[n,i]);const b=o/i*100,I=(()=>{switch(j){case"body_scan":return{color:"#8b5cf6",emoji:"ðŸ§˜â€â™€ï¸"};case"loving_kindness":return{color:"#ec4899",emoji:"ðŸ’–"};case"breath_focus":return{color:"#0ea5e9",emoji:"ðŸ«"};case"grounding":return{color:"#10b981",emoji:"ðŸŒ±"};default:return{color:"#6366f1",emoji:"âœ¨"}}})();return e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"text-4xl mb-3",children:I.emoji}),e.jsx("h2",{className:"text-2xl font-semibold text-slate-800 mb-2",children:t.title}),t.description&&e.jsx("p",{className:"text-slate-600",children:t.description}),e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:"inline-block px-3 py-1 bg-slate-100 text-slate-600 rounded-full text-xs font-medium uppercase tracking-wide",children:j.replace(/_/g," ")})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between text-sm text-slate-600 mb-2",children:[e.jsx("span",{children:u(o)}),e.jsxs("span",{children:["Target: ",u(i)]})]}),e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2",children:e.jsx("div",{className:"h-2 rounded-full transition-all duration-500",style:{width:`${Math.min(b,100)}%`,backgroundColor:I.color}})})]}),x&&e.jsxs("div",{className:"bg-gradient-to-br from-slate-50 to-white border border-slate-200 rounded-xl p-6 mb-6 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Meditation Guide"}),e.jsx("button",{onClick:()=>y(!1),className:"text-xs text-slate-500 hover:text-slate-700",children:"Hide"})]}),e.jsx("div",{className:"prose prose-sm max-w-none",children:e.jsx("p",{className:"text-slate-700 leading-relaxed whitespace-pre-wrap",children:g})})]}),!x&&e.jsx("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-6 mb-6 text-center",children:e.jsx("button",{onClick:()=>y(!0),className:"text-sm text-indigo-600 hover:text-indigo-700 font-medium",children:"Show Meditation Guide"})}),n&&e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsx("div",{className:"relative",children:e.jsx("div",{className:"w-32 h-32 rounded-full flex items-center justify-center text-white font-semibold transition-all duration-1000",style:{backgroundColor:I.color,animation:"pulse 4s ease-in-out infinite"},children:e.jsx("span",{className:"text-lg",children:u(o)})})})}),e.jsxs("div",{className:"flex gap-3 justify-center items-center",children:[!n&&o===0?e.jsxs("button",{onClick:w,className:"flex items-center gap-2 px-6 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors",children:[e.jsx(P,{size:20}),"Begin Meditation"]}):n?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:N,className:"flex items-center gap-2 px-6 py-3 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-lg font-medium transition-colors",children:[e.jsx(Q,{size:20}),"Pause"]}),e.jsxs("button",{onClick:l,className:"flex items-center gap-2 px-6 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-medium transition-colors",children:[e.jsx(U,{size:20}),"Complete"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:s,className:"flex items-center gap-2 px-6 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors",children:[e.jsx(P,{size:20}),"Resume"]}),e.jsxs("button",{onClick:l,className:"flex items-center gap-2 px-6 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-medium transition-colors",children:[e.jsx(U,{size:20}),"Complete"]})]}),a&&!n&&o===0&&e.jsx("button",{onClick:a,className:"px-4 py-3 text-slate-500 hover:text-slate-700 transition-colors",children:"Skip Step"})]}),!n&&o===0&&e.jsxs("div",{className:"mt-8 p-4 bg-blue-50 border border-blue-100 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-2",children:"ðŸ’¡ Meditation Tips"}),e.jsxs("ul",{className:"text-xs text-blue-800 space-y-1",children:[e.jsx("li",{children:"â€¢ Find a comfortable seated or lying position"}),e.jsx("li",{children:"â€¢ Close your eyes or maintain a soft gaze"}),e.jsx("li",{children:"â€¢ Let thoughts pass without judgment"}),e.jsx("li",{children:"â€¢ Return gently to the practice when distracted"})]})]}),e.jsx("style",{jsx:!0,children:`
        @keyframes pulse {
          0%, 100% {
            transform: scale(1);
            opacity: 1;
          }
          50% {
            transform: scale(1.05);
            opacity: 0.9;
          }
        }
      `})]})},tt=({step:t,onComplete:r,onSkip:a,sessionContext:m})=>{const n=qe[t.kind]||{label:"Unknown Step",icon:"â“",color:"#6b7280"},c={step:t,onComplete:r,onSkip:a,sessionContext:m,metadata:n};switch(t.kind){case"check_in":return e.jsx(Ze,{...c});case"breath":return e.jsx(Xe,{...c});case"meditation":return e.jsx(et,{...c});case"journaling":return e.jsx(A,{...c,message:"Journaling step coming soon"});case"yoga":return e.jsx(A,{...c,message:"Yoga/Movement step coming soon"});case"education":return e.jsx(A,{...c,message:"Education step coming soon"});case"reflection":return e.jsx(A,{...c,message:"Reflection step coming soon"});case"media":return e.jsx(A,{...c,message:"Media step coming soon"});case"provider_suggestion":return e.jsx(A,{...c,message:"Provider suggestion coming soon"});default:return e.jsxs("div",{className:"p-6 bg-red-50 border border-red-200 rounded-xl text-center",children:[e.jsx("div",{className:"text-red-600 font-semibold mb-2",children:"âš ï¸ Unsupported Step Type"}),e.jsxs("div",{className:"text-sm text-red-500",children:["Unknown step kind: ",e.jsx("code",{children:t.kind})]}),a&&e.jsx("button",{onClick:a,className:"mt-4 px-4 py-2 bg-red-100 hover:bg-red-200 text-red-700 rounded-lg text-sm",children:"Skip This Step"})]})}},A=({step:t,metadata:r,onComplete:a,onSkip:m,message:n})=>e.jsxs("div",{className:"p-8 bg-slate-50 border-2 border-dashed border-slate-300 rounded-xl text-center",children:[e.jsx("div",{className:"text-4xl mb-3",children:r.icon}),e.jsx("div",{className:"text-lg font-semibold text-slate-700 mb-2",children:t.title}),t.description&&e.jsx("div",{className:"text-sm text-slate-500 mb-4",children:t.description}),e.jsx("div",{className:"inline-block px-4 py-2 bg-amber-100 text-amber-700 text-sm rounded-lg mb-4",children:n}),e.jsxs("div",{className:"flex gap-3 justify-center mt-6",children:[m&&e.jsx("button",{onClick:m,className:"px-4 py-2 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-lg text-sm",children:"Skip"}),a&&e.jsx("button",{onClick:a,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg text-sm",children:"Continue"})]})]}),st=({sessionPlan:t,onComplete:r,onExit:a})=>{const[m,n]=p.useState(0),[c,o]=p.useState([]),[f]=p.useState(Date.now()),[x,y]=p.useState(!1),h=t.steps[m],g=m===t.steps.length-1,d=F[t.intent]||F.custom,j=(m+1)/t.steps.length*100,i=l=>{const b={stepId:h.id,stepKind:h.kind,stepOrder:h.order,completedAt:new Date().toISOString(),data:l||{}};o(v=>[...v,b]),g?y(!0):n(v=>v+1)},u=()=>{const l={stepId:h.id,stepKind:h.kind,stepOrder:h.order,skipped:!0,skippedAt:new Date().toISOString()};o(b=>[...b,l]),g?y(!0):n(b=>b+1)},w=()=>{m>0&&(n(l=>l-1),o(l=>l.slice(0,-1)))},N=()=>{const l=Math.floor((Date.now()-f)/1e3),b={sessionId:t.id,userId:t.userId,intent:t.intent,title:t.title,completedAt:new Date().toISOString(),durationSeconds:l,stepsCompleted:c.filter(v=>!v.skipped).length,stepsSkipped:c.filter(v=>v.skipped).length,totalSteps:t.steps.length,stepData:c};console.log("Session completed:",b),r&&r(b)},s=()=>{const l=Math.floor((Date.now()-f)/1e3),b=Math.floor(l/60),v=l%60;return`${b}:${v.toString().padStart(2,"0")}`};if(x){const l=Math.floor((Date.now()-f)/1e3),b=c.filter(v=>!v.skipped).length;return e.jsxs(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-2xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full mb-4",style:{backgroundColor:`${d.color}20`},children:e.jsx("span",{className:"text-4xl",children:d.icon})}),e.jsx("h1",{className:"text-3xl font-bold text-slate-800 mb-2",children:"Session Complete! ðŸŽ‰"}),e.jsxs("p",{className:"text-slate-600",children:["Well done on completing your ",t.title]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-white border border-indigo-100 rounded-xl p-4 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-indigo-600",children:[Math.floor(l/60),"m"]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:"Duration"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-white border border-emerald-100 rounded-xl p-4 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-emerald-600",children:[b,"/",t.steps.length]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:"Steps Done"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-white border border-purple-100 rounded-xl p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:"100%"}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:"Complete"})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6 mb-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ve,{className:"w-5 h-5 text-indigo-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-800 mb-2",children:"AI Insight"}),e.jsx("p",{className:"text-sm text-slate-700 leading-relaxed",children:t.aiSummary||"Great work completing this session! Regular practice of these techniques will build lasting resilience and emotional regulation skills."})]})]})}),t.followUpSuggestions&&t.followUpSuggestions.length>0&&e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl p-6 mb-6",children:[e.jsx("h3",{className:"font-semibold text-slate-800 mb-3",children:"ðŸ’¡ Next Steps"}),e.jsx("ul",{className:"space-y-2",children:t.followUpSuggestions.map((v,I)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm text-slate-700",children:[e.jsx("span",{className:"text-indigo-600 mt-0.5",children:"â€¢"}),e.jsx("span",{children:v})]},I))})]}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx("button",{onClick:N,className:"px-6 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors",children:"Finish & Save"}),a&&e.jsx("button",{onClick:a,className:"px-6 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg font-medium transition-colors",children:"Exit"})]})]})}return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-white",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-white border-b border-slate-200 shadow-sm",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-2xl",children:d.icon}),e.jsx("h1",{className:"text-lg font-semibold text-slate-800",children:t.title})]}),e.jsxs("div",{className:"text-xs text-slate-500",children:["Step ",m+1," of ",t.steps.length]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[e.jsx(we,{size:16}),e.jsx("span",{className:"font-mono",children:s()})]}),a&&e.jsx("button",{onClick:a,className:"text-sm text-slate-500 hover:text-slate-700 px-3 py-1 rounded-lg hover:bg-slate-100 transition-colors",children:"Exit"})]})]}),e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2",children:e.jsx(E.div,{className:"h-2 rounded-full",style:{backgroundColor:d.color},initial:{width:0},animate:{width:`${j}%`},transition:{duration:.3}})})]})}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsx(Se,{mode:"wait",children:e.jsx(E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:e.jsx(tt,{step:h,onComplete:i,onSkip:u,sessionContext:{sessionId:t.id,intent:t.intent,currentStepIndex:m,totalSteps:t.steps.length}})},h.id)}),m>0&&e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{onClick:w,className:"text-sm text-slate-500 hover:text-slate-700 underline",children:"â† Go back to previous step"})})]}),e.jsxs("div",{className:"fixed bottom-6 right-6 bg-white border border-slate-200 rounded-full px-4 py-2 shadow-lg flex items-center gap-2",children:[e.jsx(Ne,{size:16,className:"text-emerald-500"}),e.jsxs("span",{className:"text-sm font-medium text-slate-700",children:[c.filter(l=>!l.skipped).length," completed"]})]})]})},nt=()=>{const t=re(),r=Y(),a=t.state?.sessionPlan;if(!a)return r("/sessions/templates"),null;const m=c=>{console.log("Session completed:",c),r("/sessions/templates",{state:{message:"Session completed successfully!"}})},n=()=>{window.confirm("Are you sure you want to exit this session? Your progress will not be saved.")&&r("/sessions/templates")};return e.jsx(st,{sessionPlan:a,onComplete:m,onExit:n})},ct=Object.freeze(Object.defineProperty({__proto__:null,default:nt},Symbol.toStringTag,{value:"Module"}));export{Be as A,De as P,lt as S,Ie as _,k as a,ct as b,ot as c,_ as d,ke as g,Pe as u};
